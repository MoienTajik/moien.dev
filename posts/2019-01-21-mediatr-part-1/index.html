<!doctype html><html lang=en class="wf-firasans-n4-active wf-active"><head><link href=http://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=generator content="Hugo 0.121.0"><title>Implementing CQRS with MediatR - Part 1 &#183; Moien Tajik</title>
<meta content="Moien Tajik" property="og:site_name"><meta content="Implementing CQRS with MediatR - Part 1 - Moien Tajik" property="og:title"><meta content="This series explores the implementation of the CQRS design pattern using the MediatR library." property="og:description"><meta content="/Mediator.jpg" property="og:image"><link href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i|Roboto+Mono:300,300i,400,400i" rel=stylesheet><style media=print>.sidebar{display:none!important}.container,.content{width:100%;float:none;display:initial;margin:0 auto}.container{padding-left:1rem;padding-right:1rem}</style><link rel=stylesheet href=/css/poole.css><link rel=stylesheet href=/css/hyde.css><link rel=stylesheet href=/css/custom.css><script defer src=https://use.fontawesome.com/releases/v5.0.13/js/all.js integrity=sha384-xymdQtn1n3lH2wcu0qhcdaOpQwyoarkgLVxC/wZ5q7h9gHtxICrpcaSUfygqZGOe crossorigin=anonymous></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png></head><body class=theme-base-te><div class=sidebar><div class="container text-center"><div class="sidebar-about text-center"><img src=/img/Moien%20Tajik.png alt="Moien Tajik's Image" class="img-circle headshot center">
<a href=/ class=no-decoration><h1 class=brand>Moien Tajik</h1></a><p class=lead>Principal Software Engineer</p></div><div><ul class=sidebar-nav><li><a href=/><span>Home</span></a></li><li><a href=/posts/><span>Posts</span></a></li><li><a href=/tags/><span>Tags</span></a></li></li></ul></div><p><section class="row text-center"><a href=https://twitter.com/MoienTajik><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a>
&nbsp;<a href=https://github.com/MoienTajik><i class="fab fa-github fa-lg" aria-hidden=true></i></a>
&nbsp;<a href=https://linkedin.com/in/MoienTajik><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a>
&nbsp;<a href=https://stackoverflow.com/story/moientajik><i class="fab fa-stack-overflow fa-lg" aria-hidden=true></i></a>
&nbsp;<a href=https://medium.com/@MoienTajik><i class="fab fa-medium fa-lg" aria-hidden=true></i></a>
&nbsp;<a href=mailto:moientajik@hotmail.com><i class="fas fa-at fa-lg" aria-hidden=true></i></a></section></p><p class=copyright>&copy; 2024 Moien Tajik</br><a href=https://creativecommons.org/licenses/by/4.0>All rights reserved</a></p></div><div></div></div><div class="content container"><div class=post><h1 class=postTitle>Implementing CQRS with MediatR - Part 1</h1><div class="col-sm-12 col-md-12"><span class="text-left post-date meta"><i class="fas fa-calendar-alt"></i> <span class=subtitle>Publish Date: Jan 21, 2019</span><br><i class="fas fa-tags"></i>
Tags:
<a class=meta href=/tags/cqrs>cqrs</a>
,
<a class=meta href=/tags/designpatterns>designpatterns</a>
,
<a class=meta href=/tags/eventsourcing>eventsourcing</a>
,
<a class=meta href=/tags/mediator>mediator</a>
,
<a class=meta href=/tags/mediatr>mediatr</a><br></span></div><hr><img src=/posts/2019-01-21-mediatr-part-1/Mediator.jpg width=400px class=post-image><p>Implementing the CQRS pattern, although possible with ready-to-use libraries like <a href=https://github.com/tyronegroves/SimpleCQRS>SimpleCQRS</a>, can be complex and code-intensive.</p><p>The <a href=https://github.com/jbogard/MediatR>MediatR</a> library, created by the developer of the popular AutoMapper library, offers a full implementation of the <a href=https://moien.dev/posts/2019-01-19-mediator-design-pattern>Mediator design pattern</a> in .NET. This library abstracts the complexities of CQRS implementation, allowing you to incorporate CQRS into your projects with minimal code.</p><p>In this series, we will comprehensively review the CQRS pattern, discuss its pros and cons, and demonstrate its implementation using the MediatR library.</p><hr><h3 id=cqrs>CQRS</h3><p>In CQRS, application methods are divided into two categories: <strong>Read</strong> and <strong>Write</strong>. Commands modify the overall state of the application, including the database, cookies, sessions, local storage, memory, etc. Queries, on the other hand, merely read the system state without altering it.</p><p><strong>Note:</strong> Commands usually have imperative naming conventions, e.g., RegisterUser, SendForgottenPasswordEmail, PlaceOrder.</p><p><div class=custom-linebreak></div><strong>Advantages:</strong></p><p>1- You can easily separate the technologies used for the Command and Query sides of your application. For example, Apache Cassandra is a reliable (Write Side), while ElasticSearch excels in data retrieval due to its exceptional speed and complex query capabilities.</p><p>2- In typical applications, the Read Side is often utilized more than the Write Side. This allows you to scale the Read Side by allocating more resources or systems (Horizontal Scaling, Vertical Scaling).</p><p>3- The separation enables you to focus on different parts of your application more distinctly. Each side, Command and Query, can be modified without affecting the other.</p><p><div class=custom-linebreak></div><strong>Drawbacks:</strong></p><p>The main criticisms of this pattern is its implementation complexity. However, we aim to simplify this complexity using MediatR.</p><hr><h3 id=events>Events</h3><p>Events are occurrences that inform their consumers about a task <strong>previously</strong> completed in the system. For example, after a user successfully registers, you may want to send a notification or email. An event called <code>UserRegistered</code> can be raised, containing the username and email.</p><p>Events can have multiple consumers; therefore, you could write one EventHandler for <code>UserRegistered</code> to send an email and another to send a notification.</p><p><strong>Note:</strong> The naming convention for events is usually in the past tense, e.g., UserRegistered, OrderPlaced.</p><hr><h3 id=event-sourcing>Event Sourcing</h3><p>Event Sourcing refers to the storage of all occurred events in an append-only database within a program. In these types of databases, we can only add new events and are not capable of editing or deleting events; because the logic of an event is based on actions that have occurred in the past, and we cannot change something that has already happened!</p><p>The advantage of Event Sourcing is that we keep the state of the program at different times and can find the state of the system at a specific date. If there is an issue in the system, we can investigate its state prior to the problem occurring.</p><p>For example, consider the balance of a bank account. One way to keep this amount updated after each transaction is to have a field for the balance and directly update it after each transaction. In this method, due to directly updating this field in the database, we will lose the previous state (previous balance), and we must run multiple database queries to reach the previous state of the system.</p><p>Another approach exists where instead of constantly updating the current state, we add all events affecting that transaction within the system to a database. In this case, because we have all the occurred events in the program, we can simulate and understand the current state of the system.</p><p><strong>*</strong> In this tutorial series, we will use the Event Store database for implementing Event Sourcing.</p></div><hr><div class=footer><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script type=text/javascript>hljs.configure({languages:[]}),hljs.initHighlightingOnLoad()</script><h2>Comments</h2><div id=disqus_thread></div><script type=text/javascript>(function(){if(location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="moientajik",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div></body></html>